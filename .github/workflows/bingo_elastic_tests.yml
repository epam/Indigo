name: bingo_elastic_tests
on: push

jobs:
  bingo_elastic_tests:
    name: Run tests on bingo-elastic
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 
        uses: actions/checkout@v2
      - name: Set up JDK 1.8
        uses: actions/setup-java@v1
        with:
          java-version: 1.8
      - name: Cache Maven packages
        uses: actions/cache@v2
        with:
          path: ~/.m2
          key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
          restore-keys: ${{ runner.os }}-m2
      - name: Build indigo 
        run: python build_scripts/indigo-release-libs.py --preset=linux64
      - name: Build indigo java api
        run: mvn clean install
        working-directory: api/java
      - name: Build bingo-nosql
        run: mvn clean install 
        working-directory: api/plugins/bingo/java
      - name: Build bingo-elastic
        run: mvn -B test --file pom.xml
        working-directory: api/plugins/bingo-elastic/java
   
