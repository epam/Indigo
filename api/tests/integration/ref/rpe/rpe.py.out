Testing reaction products enumberator with different options

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
  N[C@@H](CCCCN)C(=O)N[C@@H](CCCCN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
  N[C@@H](CCCCN)C(=O)N[C@@H](CCCCN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
  N[C@@H](CCCCN)C(=O)N[C@@H](CCCCN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
  N[C@@H](CCCCN)C(=O)N[C@@H](CCCCN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(=O)NCC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(=O)NCC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@H]2CC=CC[C@@H]12
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](OC(C)=O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1OC(C)=O
  CC(=O)O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@@H](OC(C)=O)[C@@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](COC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](CO)O[C@@H](O)[C@@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCC(=O)NCC(=O)N[C@@H](CCCCN)C(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCC(=O)NCCCC[C@@H](NC(=O)CNC(=O)CN)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCCCC[C@@H](NC(=O)CNC(=O)CNC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(=O)NCC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(=O)NCC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@H]2CC=CC[C@@H]12
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](OC(C)=O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1OC(C)=O
  CC(=O)O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@@H](OC(C)=O)[C@@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](COC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](CO)O[C@@H](O)[C@@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCC(=O)NCC(=O)N[C@@H](CCCCN)C(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCC(=O)NCCCC[C@@H](NC(=O)CNC(=O)CN)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCCCC[C@@H](NC(=O)CNC(=O)CNC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
  N[C@@H](CCCCN)C(=O)N[C@@H](CCCCN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(=O)NCC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(=O)NCC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@H]2CC=CC[C@@H]12
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](OC(C)=O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1OC(C)=O
  CC(=O)O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@@H](OC(C)=O)[C@@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](COC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](CO)O[C@@H](O)[C@@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCC(=O)NCC(=O)N[C@@H](CCCCN)C(O)=O
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  CC1C=CC[C@@H]2[C@H]1CCC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](N)C(=O)NCC(O)=O
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
  N[C@@H](CCCCN)C(=O)N[C@@H](CCCCN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(=O)NCC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 10
  ClSBr
Test 11
  CC(=O)N[C@@H](CC1=CNC=N1)C(=O)N[C@H](CO)C(=O)N[C@@H](CCC(N)=O)C(=O)NCC(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H]([C@@H](C)O)C(=O)N[C@@H](CO)C(=O)N[C@@H](CC(O)=O)C(=O)*(**(N[C@@H](CC1C=CC(O)=CC=1)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](CCCNC(N)=N)C(=O)N[C@@H](C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H](CC1C=CC=CC=1)C(=O)N[C@@H](C(C)C)C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@@H](CC1=CNC2C=CC=CC1=2)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CC(O)=O)C(=O)N[C@@H]([C@@H](C)O)C(N)=O)C(=O)CCCCN1C=C(CCC(=O)*(N[C@@H]([C@@H](C)O)C(O)=O)**********2************(SC[C@@H]3NC(=O)[C@H](CSSC[C@H](NC(=O)[C@@H](NC(=O)[C@H](CO)NC(=O)[C@@H](NC3=O)[C@@H](C)O)[C@@H](C)CC)C(=O)*********2N[C@@H](CC(N)=O)C(O)=O)N*****)******)N=N1)C(=O)CC[C@H](NC(=O)CC[C@H](NC(=O)CCCCCCCCCCCCCCC)C(O)=O)C(O)=O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(N[C@@H]([C@@H](C)O)C(O)=O)C(=O)CCC3=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)***************************)N=N3)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)******)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(NCC(=O)N[C@@H](CCC(O)=O)C(=O)N[C@@H](CCCNC(N)=N)C(=O)NCC(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=CC=C3)C(=O)N[C@@H](CC3=CC=C(O)C=C3)C(=O)N[C@@H]([C@@H](C)O)C(=O)N3CCC[C@H]3C(=O)N[C@@H](CCCCN)C(=O)N[C@@H]([C@@H](C)O)C(O)=O)*(N[C@@H](CC(N)=O)C(O)=O)********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)C(=O)[C@H](CC(C)C)NC(=O)[C@H](CC1=CN=CN1)NC(=O)[C@H](CCC(N)=O)NC(=O)[C@H](CC(N)=O)NC(=O)[C@@H](NC(=O)[C@H](CC1=CC=CC=C1)NC(=O)CCC1=CN(CCCCC(=O)*(NCC(=O)N[C@@H](CCCNC(N)=N)C(N)=O)****************************)N=N1)C(C)C)[C@@H](C)O
Test 12
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCCCC(=O)NCCCC[C@@H](C(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)N(CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)CC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCOCC(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)(COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)COCCC(=O)NCCO[C@H]3OC(CO)[C@@H](O)C(O)[C@H]3O)C(=O)N2)NC1=O)******C(=O)CCOCC(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)(COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)COCCC(=O)NCCO[C@H]1OC(CO)[C@@H](O)C(O)[C@H]1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********(*O)C(=O)CCOCC(COCCC(=O)NCCO[C@@H]3O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]3O)(COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)COCCC(=O)NCCOC3OC(C)C(O)C(O)C3O)*(*O)********C(=O)[C@H](CSSC[C@H](N*****C(=O)CCCCC(=O)NCCOC3OC(COC4OC(CO)C(O)C(O)C4O)C(O)C(OC4OC(CO)C(O)C(O)C4O)C3O)C(=O)N2)NC1=O)******C(=O)CCCCC(=O)NCCOC1OC(COC2OC(CO)C(O)C(O)C2O)C(O)C(OC2OC(CO)C(O)C(O)C2O)C1O)[C@@H](C)O
  CC[C@H](C)[C@@H]1NC(=O)[C@H](CO)NC(=O)[C@@H](NC(=O)[C@@H]2CS*(************(**********O)*(********C(=O)[C@H](CSSC[C@H](N*****)C(=O)N2)NC1=O)*O)******)[C@@H](C)O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(=O)NCC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O
  C[C@@H]1CC=CC[C@]1(C)C=O
  C[C@@]1(CC=CC[C@]1(C)F)C=O
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12
  O=C1CC[C@@H]2CC=CC[C@H]12
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@@H]2CC=CC[C@H]12
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@H]2CC=CC[C@@H]12
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](OC(C)=O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1OC(C)=O
  CC(=O)O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@@H](OC(C)=O)[C@@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
  O=C1NCC2OC2C(=O)NCC2OC12
  O=C1NCC2OC2C(=O)NCC2OC2C(=O)NCC2OC12
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](COC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](CO)O[C@@H](O)[C@@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCC(=O)NCC(=O)N[C@@H](CCCCN)C(O)=O
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O
  NCCCC[C@@H](NC(=O)CN)C(O)=O
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1C=CC(=CC=1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C(=O)N(C(C2C=CC(=CC=2)[N+]([O-])=O)C(=O)NC2CCCCC2)[C@H]2CCC[C@H]2C(=O)N(C(C2C=CC(=CC=2)[N+]([O-])=O)C(=O)NC2CCCCC2)[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1C=CC(=CC=1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C(=O)N(C(C2C=CC(=CC=2)[N+]([O-])=O)C(=O)NC2CCCCC2)[C@H]2CCC[C@H]2C1=O
