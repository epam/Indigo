import sys

sys.path.append("../../common")
from env_indigo import *


def fp_density(fp):
    s = fp.toString()
    ones = [c for c in s if c == "1"]
    return float(len(ones)) / len(s)


descriptors = [
    [0.0] * 115,
    [1.0] * 115,
    [
        0.5305974112,
        -0.0570138889,
        0.5305974112,
        0.0160185185,
        0.5501217966,
        0.360318,
        0.34419,
        0.3600845175,
        0.34,
        0.0,
        0.3390037868,
        0.7387697636,
        0.4775395271,
        0.3390037868,
        0.1307692308,
        0.1923076923,
        0.2461538462,
        0.3043527355,
        0.2542391613,
        0.2461233746,
        0.1745339886,
        0.1745339886,
        0.3054530453,
        0.1808726824,
        0.1808726824,
        0.2394955678,
        0.1197477839,
        0.1371154665,
        0.1371154665,
        0.0887171219,
        0.0887171219,
        1.42,
        2.2708e-06,
        0.2312401434,
        0.1854625629,
        0.2297415032,
        0.1495141053,
        0.4921695174,
        0.2828240831,
        0.0,
        0.0,
        0.0,
        0.5969305288,
        0.2397268592,
        0.2397268592,
        0.0,
        0.0,
        0.3033183534,
        0.1213273414,
        0.069237372,
        0.0,
        0.4858116179,
        0.1193861058,
        0.0,
        0.0,
        0.0,
        0.069237372,
        0.0,
        0.2982891977,
        0.0,
        0.2874755917,
        0.2368431477,
        0.0,
        0.5749511833,
        0.0,
        0.1704513797,
        0.1198634296,
        0.0,
        0.1728172588,
        0.2426546827,
        0.0,
        0.0,
        0.0,
        0.318,
        0.1193861058,
        0.2397268592,
        0.0,
        0.1131296332,
        0.0,
        0.0,
        0.4764117834,
        0.3033183534,
        0.0,
        0.0473686295,
        0.1276631849,
        0.0,
        0.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.4016666667,
        0.1111111111,
        0.325,
        0.1,
        0.4,
        0.0,
        0.0,
        0.0,
        0.1,
        0.0,
        0.1,
        0.3,
        0.1,
        0.2,
        0.2,
        0.0,
        0.0,
        0.0,
        0.1,
        0.565505,
        0.2235515,
    ],
    [
        0.6664728831,
        -1.3490452726,
        0.6664728831,
        0.1465003516,
        0.5534046105,
        0.949174,
        0.888694,
        0.9484098489,
        0.89,
        0.0,
        0.2988841558,
        0.7465562799,
        0.4931125598,
        0.2988841558,
        0.1121212121,
        0.1848484848,
        0.2515151515,
        0.1851702472,
        0.9797332988,
        0.5937586974,
        0.4864776926,
        0.5068901072,
        0.7877793643,
        0.558826068,
        0.6308292344,
        0.8232810316,
        0.5085372648,
        0.5871841157,
        0.7766478024,
        0.4109950513,
        0.5558900166,
        1.88,
        0.0806603112,
        0.5849981624,
        0.461931412,
        0.4397669312,
        0.3855614679,
        0.7310375603,
        0.2893479083,
        0.2758350359,
        0.5011645577,
        0.5559266895,
        0.0,
        0.473817006,
        0.4208898492,
        0.719393816,
        0.0,
        0.3336139706,
        0.3859133201,
        0.3322669761,
        0.7069111411,
        0.3288664985,
        0.2105669259,
        0.0,
        0.7238391877,
        0.1761917996,
        0.3158460112,
        0.3983357957,
        0.3424683328,
        0.0,
        0.8568683911,
        0.5148064924,
        0.0,
        0.5749511833,
        0.0,
        0.7720494406,
        0.587294619,
        0.0,
        0.2596222402,
        0.2788912186,
        0.0,
        0.5605314356,
        0.0,
        0.5671,
        0.1558255805,
        0.3303083542,
        0.0,
        0.1071988797,
        0.6155309397,
        0.1211474962,
        0.2246754732,
        0.6311693297,
        0.2089514638,
        0.1996654858,
        0.1184215738,
        0.0,
        0.4075477364,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.2968664334,
        0.5176144721,
        0.5,
        0.825,
        0.1,
        1.0,
        0.0,
        0.1,
        0.1,
        0.1,
        0.2,
        0.3,
        0.8,
        0.1,
        0.55,
        0.7,
        0.0,
        0.1,
        0.1,
        0.4,
        0.580545,
        0.6299275,
    ],
    [
        0.6356019019,
        0.2154875676,
        0.6356019019,
        0.0828013808,
        0.4855439129,
        0.913998,
        0.863598,
        0.9122773494,
        0.81,
        0.0,
        0.3084624468,
        0.72993984,
        0.4598796799,
        0.3084624468,
        0.1161290322,
        0.1838709677,
        0.2483870968,
        0.1911771957,
        0.8782370572,
        0.5624817761,
        0.4621355463,
        0.5014461845,
        0.7273766256,
        0.506564333,
        0.5662873857,
        0.8695187702,
        0.5167409197,
        0.5137180834,
        0.6581577082,
        0.3673555702,
        0.5013481026,
        1.755,
        0.0230135092,
        0.5427959722,
        0.393798224,
        0.4164514993,
        0.3809900488,
        0.2368431477,
        0.5617094529,
        0.2912202249,
        0.0,
        0.0,
        0.2984652644,
        0.7177020782,
        0.0,
        0.0,
        0.5383537374,
        0.5933418507,
        0.5923860883,
        0.2102668349,
        0.3033126656,
        0.2382850034,
        0.3461871606,
        0.0,
        0.3691115816,
        0.1248101183,
        0.5960613646,
        0.0,
        0.6250441225,
        0.0,
        0.2500540988,
        0.0,
        0.0,
        0.0,
        0.5734431442,
        0.3204650437,
        0.2382850034,
        0.51928029,
        0.6645018472,
        0.2925787301,
        0.2511316657,
        0.1250270494,
        0.0,
        0.34685,
        0.1164289164,
        0.1198634296,
        0.0,
        0.1239012691,
        0.1084703781,
        0.3322752595,
        0.1219286798,
        0.2834196469,
        0.5652751672,
        0.2404483802,
        0.5332551894,
        0.0,
        0.6954098243,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0202921987,
        0.583488316,
        0.3913043478,
        0.775,
        0.0,
        0.6,
        0.0,
        0.1,
        0.1,
        0.1,
        0.2,
        0.3,
        0.7,
        0.0,
        0.4,
        0.3,
        0.0,
        0.0,
        0.0,
        0.4,
        0.776568,
        0.618705,
    ],
    [
        0.5836018518,
        0.32,
        0.5836018518,
        0.316574074,
        0.5384628262,
        0.388388,
        0.368228,
        0.3881607511,
        0.37,
        0.0,
        0.3317034326,
        0.663931733,
        0.3317034326,
        0.327863466,
        0.1142857143,
        0.1785714286,
        0.2428571428,
        0.3221281081,
        0.4566878459,
        0.2613916362,
        0.2045675308,
        0.2045675308,
        0.326829063,
        0.2053963821,
        0.2053963821,
        0.3233448966,
        0.1616724483,
        0.2316512895,
        0.2316512895,
        0.1471179885,
        0.1471179885,
        1.425,
        5.8384e-06,
        0.2183808317,
        0.1283973951,
        0.0875774163,
        0.158057914,
        0.2283549824,
        0.0,
        0.5581938969,
        0.0,
        0.5559266895,
        0.2844871699,
        0.696436824,
        0.4889257852,
        0.0,
        0.0,
        0.0,
        0.0,
        0.2114301595,
        0.1581830019,
        0.0,
        0.1116387794,
        0.0,
        0.4671319366,
        0.5285753987,
        0.0,
        0.0,
        0.2716540474,
        0.0,
        0.0,
        0.5624505147,
        0.0,
        0.0,
        0.0,
        0.1868527746,
        0.5285753987,
        0.0,
        0.0,
        0.1591639444,
        0.0,
        0.2790969485,
        0.0,
        0.3091,
        0.0,
        0.2397268592,
        0.0,
        0.1124901029,
        0.1116387794,
        0.0456709965,
        0.4485522926,
        0.4665610903,
        0.0,
        0.0498397852,
        0.0,
        0.0,
        0.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0403953704,
        0.3362712963,
        0.375,
        0.35,
        0.0,
        0.6,
        0.0,
        0.0,
        0.0,
        0.0,
        0.2,
        0.2,
        0.6,
        0.0,
        0.3,
        0.0,
        0.0,
        0.0,
        0.0,
        0.2,
        0.448535,
        0.25598,
    ],
    [
        0.2068518518,
        0.8049537037,
        0.2068518518,
        0.6099074074,
        0.6261518225,
        0.324472,
        0.296248,
        0.3242313969,
        0.32,
        0.0,
        0.0360296665,
        0.6496535744,
        0.2993071487,
        0.0360296665,
        0.1583333333,
        0.25,
        0.3083333333,
        0.2194591658,
        0.1816854141,
        0.2097226264,
        0.185062472,
        0.185062472,
        0.2938505049,
        0.2239489196,
        0.2239489196,
        0.3424992539,
        0.1712496269,
        0.2589629436,
        0.2589629436,
        0.1904487451,
        0.1904487451,
        0.945,
        3.3389e-06,
        0.1935833907,
        0.1616466963,
        0.1344570624,
        0.1464595284,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.4941944126,
        0.0,
        0.0,
        0.0,
        0.1516591767,
        0.3806389019,
        0.1843552797,
        0.0,
        0.0,
        0.0,
        0.0,
        0.2470972063,
        0.0,
        0.1888348407,
        0.1359242839,
        0.3008987277,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.2347631664,
        0.0,
        0.0,
        0.2444693557,
        0.2452642128,
        0.0,
        0.0,
        0.0,
        0.08065,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0604184083,
        0.0,
        0.6237462786,
        0.0,
        0.1846005421,
        0.229979273,
        0.0,
        0.0,
        0.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.225,
        0.5,
        0.3,
        0.0,
        0.2,
        0.0,
        0.1,
        0.1,
        0.0,
        0.1,
        0.1,
        0.2,
        0.0,
        0.1,
        0.1,
        0.0,
        0.1,
        0.1,
        0.2,
        0.592415,
        0.24421,
    ],
    [
        0.6839730594,
        -1.8222779188,
        0.6839730594,
        0.0007829202,
        0.6216377742,
        0.814636,
        0.784396,
        0.8142361588,
        0.76,
        0.0,
        0.4512191363,
        0.6666524371,
        0.4512191363,
        0.3333048742,
        0.1107142857,
        0.1785714286,
        0.2464285714,
        0.1626283958,
        0.6639855447,
        0.5159365931,
        0.3577456123,
        0.3577456123,
        0.6528784607,
        0.4109962738,
        0.4109962738,
        0.6430579763,
        0.3215289882,
        0.4367685432,
        0.4367685432,
        0.3008516718,
        0.3008516718,
        1.815,
        0.0044666391,
        0.5028308784,
        0.3707029399,
        0.4105785673,
        0.3089670868,
        0.7600338428,
        0.145430521,
        0.872942309,
        0.5865792114,
        0.0,
        0.3088149259,
        0.2397268592,
        0.6585622572,
        0.6585622572,
        0.2549340904,
        0.0,
        0.1805064018,
        0.3161854233,
        0.1636189101,
        0.7784256868,
        0.0590717973,
        0.0,
        0.4916093249,
        0.1433416869,
        0.381492954,
        0.0654475641,
        0.4679665715,
        0.0,
        0.0,
        0.2866833739,
        0.6585622572,
        0.0,
        0.0,
        0.3815814996,
        0.7620292534,
        0.4362915631,
        0.2363308211,
        0.1213273414,
        0.0,
        0.0,
        0.0,
        0.3852,
        0.414013861,
        0.7784256868,
        0.0,
        0.4386376845,
        0.1213273414,
        0.0456709965,
        0.1224977433,
        0.0,
        0.0,
        0.1019736362,
        0.1433416869,
        0.0,
        0.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.7926135839,
        0.1548864161,
        0.4375,
        0.7,
        0.2,
        0.6,
        0.0,
        0.1,
        0.1,
        0.1,
        0.1,
        0.2,
        0.5,
        0.1,
        0.6,
        0.4,
        0.0,
        0.0,
        0.0,
        0.3,
        0.600825,
        0.415267,
    ],
    [
        0.6464753627,
        0.4285996876,
        0.6464753627,
        0.1428006249,
        0.3894161626,
        0.98723,
        0.924734,
        0.9865180172,
        0.94,
        0.0,
        0.2551591618,
        0.6619220012,
        0.3238440024,
        0.2551591618,
        0.0972972973,
        0.1783783784,
        0.254054054,
        0.123529956,
        1.0004120481,
        0.6403577232,
        0.5296350918,
        0.5296350918,
        0.9015004889,
        0.6228436752,
        0.6228436752,
        0.9392360223,
        0.4696180111,
        0.6572995264,
        0.6572995264,
        0.4277829725,
        0.4277829725,
        2.57,
        1.0000000025,
        0.613745681,
        0.5640824583,
        0.6354664605,
        0.4339124985,
        0.7766743469,
        0.0,
        0.0,
        0.297416964,
        0.5907179729,
        0.0,
        0.7339212718,
        0.4983978521,
        0.0,
        0.0,
        0.4549775301,
        0.6756288164,
        0.7381598828,
        0.1423481999,
        0.1198634296,
        0.2323029156,
        0.0,
        0.6187938756,
        0.0,
        0.1346849361,
        0.4386027481,
        0.9594455587,
        0.0,
        0.5628689743,
        0.5316788604,
        0.4330777958,
        0.0,
        0.0,
        0.6388563236,
        0.1636189101,
        0.17309343,
        0.2148489166,
        0.792542014,
        0.0,
        0.2814344872,
        0.0,
        0.4314,
        0.0,
        0.1198634296,
        0.0,
        0.0590717973,
        0.1719917705,
        0.5523199928,
        0.1390862873,
        0.4647632679,
        0.6758740788,
        0.4243300422,
        0.0,
        0.0,
        0.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.775,
        0.2413793103,
        0.925,
        0.2,
        0.8,
        0.0,
        0.1,
        0.1,
        0.2,
        0.2,
        0.4,
        0.7,
        0.2,
        0.4,
        0.7,
        0.0,
        0.1,
        0.1,
        0.5,
        0.729516,
        0.7344695,
    ],
    [
        0.5773533742,
        0.5404538406,
        0.5773533742,
        0.0809076812,
        0.6149801508,
        0.896788,
        0.842356,
        0.8942960649,
        0.8,
        0.0,
        0.2242150924,
        0.746759875,
        0.4935197501,
        0.2242150924,
        0.1,
        0.1833333333,
        0.2666666667,
        0.1154396952,
        0.6651941546,
        0.5231018621,
        0.4250505536,
        0.4628470009,
        0.7298678394,
        0.5284395557,
        0.566236003,
        0.7824330846,
        0.4304747723,
        0.5758419358,
        0.6567346235,
        0.4017137067,
        0.4432199568,
        1.475,
        0.0251255588,
        0.5322114382,
        0.4952293979,
        0.5203217188,
        0.3748846552,
        0.7476780644,
        0.1437377958,
        0.0,
        0.2953589865,
        0.0,
        0.0,
        0.4847223457,
        0.0,
        0.0,
        0.0,
        0.8833653479,
        0.4956977397,
        0.4435360059,
        0.5584883717,
        0.2382850034,
        0.4048383206,
        0.0,
        0.1224977433,
        0.0,
        0.2568328649,
        0.4954736233,
        0.5200692053,
        0.0,
        0.2874755917,
        0.7476780644,
        0.2843693137,
        0.5749511833,
        0.5800469945,
        0.5013775345,
        0.2803839702,
        0.0,
        0.2482591636,
        0.3639820241,
        0.5022633314,
        0.0,
        0.0,
        0.22405,
        0.0,
        0.1198634296,
        0.0,
        0.0590717973,
        0.2307297021,
        0.6911053128,
        0.1390862873,
        0.0,
        0.3033183534,
        0.2118297513,
        0.6984685684,
        0.0,
        0.8125662224,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.5138623999,
        0.4347826086,
        0.75,
        0.1,
        0.5,
        0.0,
        0.2,
        0.2,
        0.2,
        0.0,
        0.2,
        0.4,
        0.1,
        0.35,
        0.7,
        0.0,
        0.1,
        0.1,
        0.4,
        0.742965,
        0.6161835,
    ],
    [
        0.6089407754,
        0.2205324074,
        0.6089407754,
        0.2586574074,
        0.8571565291,
        0.47546,
        0.443204,
        0.4741840836,
        0.43,
        0.0,
        0.1569472238,
        0.6521429552,
        0.3042859105,
        0.1569472238,
        0.13125,
        0.20625,
        0.26875,
        0.2483414674,
        0.2997585162,
        0.289900296,
        0.2356010241,
        0.2544992478,
        0.3852171287,
        0.2838781716,
        0.3027763953,
        0.426545948,
        0.2336329804,
        0.3442045126,
        0.3771633347,
        0.2519809378,
        0.2816849183,
        0.93,
        1.63279e-05,
        0.290507696,
        0.2279730108,
        0.1763306184,
        0.2019896346,
        0.2658394302,
        0.1384731313,
        0.2891622473,
        0.0,
        0.0,
        0.0,
        0.2397268592,
        0.0,
        0.0,
        0.0,
        0.905521568,
        0.3151913379,
        0.1144345494,
        0.0,
        0.1198634296,
        0.1738418484,
        0.0,
        0.1329197151,
        0.0,
        0.3122221174,
        0.0704767198,
        0.3485155308,
        0.0,
        0.0,
        0.2658394302,
        0.0,
        0.0,
        0.2900234973,
        0.1283091693,
        0.2583365609,
        0.0,
        0.3124673798,
        0.2426546827,
        0.2511316657,
        0.0,
        0.0,
        0.1455,
        0.0553892525,
        0.1198634296,
        0.0,
        0.0578324495,
        0.1144345494,
        0.2482591636,
        0.0,
        0.0,
        0.3131314026,
        0.053167886,
        0.2900234973,
        0.0,
        0.654973982,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.2966215183,
        0.4615384615,
        0.4,
        0.1,
        0.2,
        1.0,
        0.0,
        0.1,
        0.1,
        0.0,
        0.1,
        0.2,
        0.1,
        0.15,
        0.2,
        1.0,
        0.0,
        0.1,
        0.2,
        0.64489,
        0.3283235,
    ],
    [
        0.6148354592,
        0.2957667234,
        0.6148354592,
        0.0970123666,
        0.7979361284,
        0.606716,
        0.56438,
        0.6062941163,
        0.59,
        0.0,
        0.3379215884,
        0.734322778,
        0.468645556,
        0.3379215884,
        0.1181818182,
        0.1909090909,
        0.2590909091,
        0.178965288,
        0.4141016165,
        0.3922467491,
        0.3224419881,
        0.3224419881,
        0.5306696101,
        0.3836538536,
        0.3836538536,
        0.6058421524,
        0.3029210762,
        0.4955460524,
        0.4955460524,
        0.3766874791,
        0.3766874791,
        1.44,
        0.0004187518,
        0.3758144855,
        0.3042448291,
        0.2608720386,
        0.2594881448,
        0.4736862954,
        0.3005468108,
        0.0,
        0.0,
        0.0,
        0.5969305288,
        0.4847223457,
        0.2397268592,
        0.0,
        0.0,
        0.4549775301,
        0.3202204937,
        0.1850450328,
        0.3168312258,
        0.4765700069,
        0.1193861058,
        0.0,
        0.1224977433,
        0.1479476512,
        0.3745011291,
        0.1415746952,
        0.3589528683,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.4918363788,
        0.3567065773,
        0.1479476512,
        0.2962045354,
        0.3033183534,
        0.0,
        0.0,
        0.0,
        0.2792,
        0.1202187243,
        0.2397268592,
        0.0,
        0.179804514,
        0.1802611394,
        0.1284164325,
        0.1777449385,
        0.6066367068,
        0.1311403905,
        0.0489990973,
        0.2368431477,
        0.0,
        0.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.5183333333,
        0.5294117647,
        0.55,
        0.0,
        0.5,
        0.0,
        0.2,
        0.2,
        0.1,
        0.0,
        0.1,
        0.5,
        0.0,
        0.25,
        0.3,
        0.0,
        0.2,
        0.2,
        0.3,
        0.593385,
        0.4017075,
    ],
    [
        0.6664728831,
        -1.3490452726,
        0.6664728831,
        0.1465003516,
        0.5534046105,
        0.949174,
        0.888694,
        0.9484098489,
        0.89,
        0.0,
        0.2988841558,
        0.7465562799,
        0.4931125598,
        0.2988841558,
        0.1121212121,
        0.1848484848,
        0.2515151515,
        0.1851702472,
        0.9797332988,
        0.5937586974,
        0.4864776926,
        0.5068901072,
        0.7877793643,
        0.558826068,
        0.6308292344,
        0.8232810316,
        0.5085372648,
        0.5871841157,
        0.7766478024,
        0.4109950513,
        0.5558900166,
        1.88,
        0.0806603112,
        0.5849981624,
        0.461931412,
        0.4397669312,
        0.3855614679,
        0.7310375603,
        0.2893479083,
        0.2758350359,
        0.5011645577,
        0.5559266895,
        0.0,
        0.473817006,
        0.4208898492,
        0.719393816,
        0.0,
        0.3336139706,
        0.3859133201,
        0.3322669761,
        0.7069111411,
        0.3288664985,
        0.2105669259,
        0.0,
        0.7238391877,
        0.1761917996,
        0.3158460112,
        0.3983357957,
        0.3424683328,
        0.0,
        0.8568683911,
        0.5148064924,
        0.0,
        0.5749511833,
        0.0,
        0.7720494406,
        0.587294619,
        0.0,
        0.2596222402,
        0.2788912186,
        0.0,
        0.5605314356,
        0.0,
        0.5671,
        0.1558255805,
        0.3303083542,
        0.0,
        0.1071988797,
        0.6155309397,
        0.1211474962,
        0.2246754732,
        0.6311693297,
        0.2089514638,
        0.1996654858,
        0.1184215738,
        0.0,
        0.4075477364,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.2968664334,
        0.5176144721,
        0.5,
        0.825,
        0.1,
        1.0,
        0.0,
        0.1,
        0.1,
        0.1,
        0.2,
        0.3,
        0.8,
        0.1,
        0.55,
        0.7,
        0.0,
        0.1,
        0.1,
        0.4,
        0.580545,
        0.6299275,
    ],
]

print("**** Test Loading Molecule Fingerprints from Molecule Descriptors ****")
indigo = Indigo()

print("**** Descriptors:")
for descrs in descriptors:
    strs = ["%.10f" % f for f in descrs]
    print("[%s]" % (", ".join(strs)))

print("**** Loaded Fingerprints:")
for index, descrs in enumerate(descriptors):
    if isIronPython():
        import System

        descrs = System.Array[float](descrs)

    fp = indigo.loadFingerprintFromDescriptors(
        descrs, 64, 0.3
    )  # Jython cannot work with named arguments
    print(
        "#%2d  Density: %0.6f ; FP: %s"
        % (index, fp_density(fp), fp.toString())
    )
